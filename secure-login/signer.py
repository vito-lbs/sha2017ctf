from sys import stdout
from multiprocessing import Pool, Queue


n = 25504352309535290475248970674346405639150033303276037621954645287836414954584485104061261800020387562499019659311665606506084209652278825297538342995446093360707480284955051977871508969158833725741319229528482243960926606982225623875037437446029764584076579733157399563314682454896733000474399703682370015847387660034753890964070709371374885394037462378877025773834640334396506494513394772275132449199231593014288079343099475952658539203870198753180108893634430428519877349292223234156296946657199158953622932685066947832834071847602426570899103186305452954512045960946081356967938725965154991111592790767330692701669
e = 65537

content = 'ticket:user|vito|vito genovese'

desired = '956be1928390cd96eecab9227996f925884ea8d81f85ee28d742b730531cef6c753d4c4107e8a157a07aee5790f6246676ddf9a3358220abd07fa6c345fa0d011a97c6ef3207519a272cceed759662da78b9955fc27cd9a1b5765381c6f0f6be5d57887dee85d09096e32d53bad5b8e9c84a35a85d2f4413193a513b497ebf807ea368419a231aa2c845c06041bcfe83a65aeecffd73dc98085ee25059b51dbd8eb3f607766176fdd295dd15f354271984f21d4bd62ce24fa5b4bd55c531867222a18ce128750462faaabd5fb7c22a493d6f07c6d1ce508447eb5b7e485d6c8e283d1c24cbdd90ee856816025bbce8870dd6c3db5f4801b4c74d48ccc332864b'

def str2num(s):
    return int(s.encode('hex'),16)

def num2str(n):
    d = ('%x' % n)
    if len(d) % 2 == 1:
        d = '0' + d
    return d.decode('hex')

def attempt(d):
    if desired == num2str(pow(plaintext, d, n)):
        results.put(num2str(pow(str2num("ticket:admin|root|"), d, n)))

plaintext = str2num(content)

pool = Pool(processes=16)
results = Queue()



result = pool.map_async(attempt, xrange(2269651, 10000000))
